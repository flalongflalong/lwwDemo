var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,f,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[f]=g.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,f,g,h){if(f){g=$jscomp.global;d=d.split(".");for(h=0;h<d.length-1;h++){var m=d[h];m in g||(g[m]={});g=g[m]}d=d[d.length-1];h=g[d];f=f(h);f!=h&&null!=f&&$jscomp.defineProperty(g,d,{configurable:!0,writable:!0,value:f})}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;
$jscomp.Symbol=function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(d){var f=0;return $jscomp.iteratorPrototype(function(){return f<d.length?{done:!1,value:d[f++]}:{done:!0}})};$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(d,f){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var g=0,h={next:function(){if(g<d.length){var m=g++;return{value:f(m,d[m]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};$jscomp.polyfill("Array.prototype.entries",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d,g){return[d,g]})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.values",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d,g){return g})}},"es6","es3");$jscomp.findInternal=function(d,f,g){d instanceof String&&(d=String(d));for(var h=d.length,m=0;m<h;m++){var z=d[m];if(f.call(g,z,m,d))return{i:m,v:z}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,g){return $jscomp.findInternal(this,d,g).v}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.keys",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6-impl","es3");
d3.biHiSankey=function(){function d(b){return parseInt(b.value)}function f(){r.forEach(function(b){N[b.id]=b;b.sourceLinks=[];b.rightLinks=[];b.targetLinks=[];b.leftLinks=[];b.connectedNodes=[];b.children=[];b.ancestors=[]})}function g(){K=r.filter(function(b){return!b.children.length})}function h(){Q=r.filter(function(b){return b.children.length})}function m(b){b.children.forEach(function(b){b.ancestors=b.ancestors.concat(this.ancestors.concat([this]));m(b)},b)}function z(){var b,c=[];r.sort(function(a,
b){return a.id.length-b.id.length});r.forEach(function(a){b=N[a.parent];a.px=parseInt(a.px)-1;a.py=parseInt(a.py)-1;a.width=0;a.height=0;a.x=0;a.y=0;a.childMaxX=parseInt(a.childMaxX?a.childMaxX:1);a.childMaxY=parseInt(a.childMaxY?a.childMaxY:1);b?(a.parent=b,a.slevel=a.parent.slevel+1,b.children.push(a)):(a.parent=null,a.slevel=0,c.push(a))});r.sort(function(a,b){return b.slevel-a.slevel});r.forEach(function(a){a.xc=0;a.yc=0;if(0==a.children.length)a.wc=a.childMaxX,a.hc=a.childMaxY;else{a.xc=2*l;
a.yc=2*l;var b=a.children;a.hc=0;a.wc=0;d3.nest().key(function(a){return a.px}).sortKeys(d3.ascending).entries(b).forEach(function(b,c){a.wc+=d3.max(b.values,function(a){return a.wc});a.xc+=d3.max(b.values,function(a){return a.xc});0<c&&(a.xc+=5*I[a.slevel+1])});d3.nest().key(function(a){return a.py}).sortKeys(d3.ascending).entries(b).forEach(function(b,c){a.hc+=d3.max(b.values,function(a){return a.hc});a.yc+=d3.max(b.values,function(a){return a.yc});0<c&&(a.yc+=I[a.slevel+1])})}});r.sort(function(a,
b){return a.slevel-b.slevel});g();h();c.forEach(function(a){m(a)})}function v(){var b,c;q.forEach(function(a){b=N[a.source]||a.source;c=N[a.target]||a.target;a.id=a.source+"-"+a.target;a.source=b;a.target=c;a.state="NORMAL";b.sourceLinks.push(a);c.targetLinks.push(a)})}function C(b){return b.filter(function(b){return"collapsed"===b.source.state&&"collapsed"===b.target.state})}function t(){K.forEach(function(b){b.sourceLinks.forEach(function(c){var a;a=c.target;0<=K.indexOf(a)&&(a=a.ancestors.filter(function(a){return 0>
b.ancestors.indexOf(a)}),a.forEach(function(a){var d={source:b,target:a,value:c.value,id:b.id+"-"+a.id};b.sourceLinks.push(d);a.targetLinks.push(d);q.push(d)}))});b.targetLinks.forEach(function(c){var a;a=c.source;0<=K.indexOf(a)&&(a=a.ancestors.filter(function(a){return 0>b.ancestors.indexOf(a)}),a.forEach(function(a){var d={source:a,target:b,value:c.value,id:a.id+"-"+b.id};a.sourceLinks.push(d);b.targetLinks.push(d);q.push(d)}))})});Q.forEach(function(b){b.sourceLinks.forEach(function(c){var a;
a=c.target;0<=K.indexOf(a)&&(a=a.ancestors.filter(function(a){return 0>b.ancestors.indexOf(a)}),a.forEach(function(a){var d={source:b,target:a,value:c.value,id:b.id+"-"+a.id};b.sourceLinks.push(d);a.targetLinks.push(d);q.push(d)}))})})}function u(){q=d3.nest().key(function(b){return b.source.id+"->"+b.target.id}).entries(q).map(function(b){return b.values}).map(function(b){return b.reduce(function(b,a){return{source:b.source,target:b.target,id:d3.min([b.id,a.id]),value:parseInt(b.value)+parseInt(a.value)}})})}
function x(){r.forEach(function(b){b.value=Math.max(d3.sum(b.leftLinks,d),d3.sum(b.rightLinks,d));b.netFlow=d3.sum(C(b.targetLinks),d)-d3.sum(C(b.sourceLinks),d);b.linkSpaceCount=Math.max(Math.max(b.leftLinks.length,b.rightLinks.length)-1,0)})}function D(){var b,c;q.forEach(function(a){b=a.source;c=a.target;0>b.connectedNodes.indexOf(c)&&b.connectedNodes.push(c);0>c.connectedNodes.indexOf(b)&&c.connectedNodes.push(b)})}function e(){var b=[];q.filter(function(b){return b.target.x===b.source.x}).forEach(function(c){0>
b.indexOf(c.target)&&b.push(c.target)});return b}function E(){d3.nest().key(function(b){return b.slevel}).sortKeys(d3.ascending).entries(r).map(function(b){return b.values}).forEach(function(b,d,a){function e(a){a.sort(function(a,b){return 1E3*a.px+a.py-(1E3*b.px+b.py)});a.forEach(function(a,b,d){a.width=a.wc*c+a.xc;a.height=a.hc*H+a.yc;2>a.slevel&&(a.width+=l*(3-a.slevel));2>a.slevel&&(a.height+=l*(2-a.slevel));0==a.slevel&&(a.height+=l*(a.childMaxY-1));b=d.filter(function(n){return n.px<a.px}).sort(function(a,
b){return b.x+b.width-(a.x+a.width)});d=d.filter(function(n){return n.py<a.py}).sort(function(a,b){return b.y+b.height-(a.y+a.height)});a.x+=0<b.length?b[0].x+b[0].width+5*I[a.slevel]:l;a.y+=0<d.length?d[0].y+d[0].height+I[a.slevel]:l})}a=[];a.push(b);0<d&&(a=d3.nest().key(function(a){return a.parent.id}).sortKeys(d3.ascending).entries(b).map(function(a){return a.values}));a.forEach(function(a){e(a)})});r.forEach(function(b,c,a){0!=b.slevel&&(c=a.filter(function(a){return a.id===b.parent.id})[0],
b.x+=c.x,b.y+=c.y)})}function G(){for(var b=r,d,a=0,l=function(a){0>d.indexOf(a.target)&&a.target.x===this.x&&d.push(a.target)},f=function(b){b.x=a;b.width=c;b.sourceLinks.forEach(l,b)};b.length;)d=[],b.forEach(f),b=d.length?d:e(),a+=1;E()}function F(){var b,c;r.forEach(function(a){a.rightLinks=[];a.leftLinks=[]});q.forEach(function(a){b=a.source;c=a.target;b.x<c.x?(b.rightLinks.push(a),c.leftLinks.push(a),a.direction=1):(b.leftLinks.push(a),c.rightLinks.push(a),a.direction=-1)})}function p(b){r.forEach(function(c){c.y-=
b})}function y(b){function c(a){e.forEach(function(a){a.forEach(function(a){})})}function a(a){e.slice().reverse().forEach(function(a){a.forEach(function(a){})})}var d,e=d3.nest().key(function(a){return a.slevel}).sortKeys(d3.ascending).entries(r).map(function(a){return a.values});(function(){var a,b,c;L=d3.min(e,function(n){a=d3.sum(n,function(a){return a.linkSpaceCount});b=d3.sum(n,function(a){return a.value});c=P[1]-(n.length-1)*l-a*M;return c/b});q.forEach(function(a){var n=Math.abs(a.source.x-
a.target.x);4>n/(a.value*L)&&(L=.25*n/a.value)})})();(function(){e.forEach(function(a){a.forEach(function(a,b){a.heightAllowance=a.childMaxY*L+M*a.linkSpaceCount})})})();(function(){q.forEach(function(a){a.thickness=d3.min([a.value*L,d3.min([.6*a.source.height/a.source.rightLinks.length,.6*a.target.height/a.target.leftLinks.length])])})})();for(d=1;0<b;--b)d*=.99,a(d),c(d);b=d3.min(r,function(a){return a.y});p(b)}function w(){function b(a,b){return(0<a.direction?a.source:a.target).y-(0<b.direction?
b.source:b.target).y}function c(a,b){return(0<a.direction?a.target:a.source).y-(0<b.direction?b.target:b.source).y}r.forEach(function(a){a.rightLinks.sort(c);a.leftLinks.sort(b)});r.forEach(function(a){var b=0,c=0;a.rightLinks.forEach(function(a){0<a.direction?"collapsed"===a.target.state&&(b+=a.thickness+.3*a.source.height/a.source.rightLinks.length):"collapsed"===a.source.state&&(b+=a.thickness+.3*a.target.height/a.target.rightLinks.length);a.sourceY=b});a.leftLinks.forEach(function(a){0>a.direction?
("collapsed"===a.target.state&&(c+=a.thickness+M),a.sourceY=c):("collapsed"===a.source.state&&(c+=a.thickness+.3*a.target.height/a.target.leftLinks.length),a.targetY=c)});var d=(a.height-(a.rightLinks[0]?a.rightLinks[0].sourceY+a.rightLinks[a.rightLinks.length-1].thickness:0)-b)/2,e=(a.height-(a.leftLinks[0]?a.leftLinks[0].targetY+a.leftLinks[a.leftLinks.length-1].thickness:0)-c)/2;a.rightLinks.forEach(function(a){0<a.direction?"collapsed"===a.target.state&&(a.sourceY+=d):a.targetY+=d});a.leftLinks.forEach(function(a){0>
a.direction?"collapsed"===a.target.state&&(a.sourceY+=e):a.targetY+=e})})}var k={},c=50,H=20,l=8,I=[80,40,15,5],M=8,O=0,P=[1,1],r=[],N={},Q=[],K=[],q=[],L=1;k.arrowheadScaleFactor=function(b){if(!arguments.length)return O;O=+b;return k};k.collapsedNodes=function(){return r.filter(function(b){return"collapsed"===b.state})};k.expandedNodes=function(){return r.filter(function(b){return"expanded"===b.state})};k.connected=function(b,c){return 0<=b.connectedNodes.indexOf(c)};k.showListNodes=function(){return r.filter(function(b){return"collapsed"===
b.state||"expanded"===b.state})};k.layout=function(b){G();F();x();y(b);x();w();return k};k.link=function(){function b(a){if(a.source.x<a.target.x){var b=a.thickness*O,d=3*a.thickness/4-b,e=a.source.x+a.source.width,b=a.target.x-d-b,l=d3.interpolateNumber(e,b),f=l(c),l=l(1-c),n=a.source.y+a.sourceY+a.thickness/2;a=a.target.y+a.targetY+a.thickness/2;return"M"+e+","+n+"C"+f+","+n+" "+l+","+a+" "+b+","+a+"L"+(b+d)+","+a}var f=a.thickness*O,d=a.thickness/4,e=a.source.x,b=e-f/2,f=a.target.x+a.target.width+
d+f,n=d3.interpolateNumber(e,f),l=n(c),n=n(1-c),g=a.source.y+a.sourceY+a.thickness/2;a=a.target.y+a.targetY+a.thickness/2;return"M"+e+","+g+"L"+b+","+g+"C"+l+","+g+" "+n+","+a+" "+f+","+a+"L"+(f-d)+","+a}var c=.2;b.curvature=function(a){if(!arguments.length)return c;c=+a;return b};return b};k.links=function(b){if(!arguments.length)return q;q=b.filter(function(b){return b.source!==b.target});return k};k.linkSpacing=function(b){if(!arguments.length)return M;M=+b;return k};k.nodes=function(b){if(!arguments.length)return r;
r=b;return k};k.nodeWidth=function(b){if(!arguments.length)return c;c=+b;return k};k.setNodeHeight=function(b){if(!arguments.length)return H;H=+b;return k};k.nodeSpacing=function(b){if(!arguments.length)return l;l=+b;return k};k.relayout=function(){F();x();w();return k};k.size=function(b){if(!arguments.length)return P;P=b;return k};k.visibleLinks=function(){return C(q)};k.initializeNodes=function(b){f();z();v();t();u();D();r.forEach(b);return k};return k};"use strict";
var OPACITY={NODE_DEFAULT:.8,NODE_FADED:.2,NODE_HIGHLIGHT:1,LINK_DEFAULT:.6,LINK_FADED:.1,LINK_HIGHLIGHT:.8},TYPES=["Structure","Unstructured","Integrated","BigData","AppData"],TYPE_COLORS="#1b9e77 #d95f02 #7570b3 #e7298a #66a61e #e6ab02 #a6761d".split(" "),TYPE_HIGHLIGHT_COLORS="#1b9e77 #d95f02 #7570b3 #e7298a #66a61e #e6ab02 #a6761d".split(" "),LINK_COLOR="#b3b3b3",INFLOW_COLOR="#8bc9fc",OUTFLOW_COLOR="#f1b7b7",TEXT_NORMAL_COLOR="#2e2e2e",OUTER_MARGIN=0,SEL_NODE_STROKE="f93a43",ZOOM_MIN=.5,ZOOM_MAX=
5,TEXT_NORMAL_SIZE=10,TEXT_BIG_SIZE=[20,15,10,10],TRANSITION_DURATION=100,COLLAPSER={RADIUS:8,SPACING:2},MARGIN={TOP:2*(COLLAPSER.RADIUS+OUTER_MARGIN),RIGHT:OUTER_MARGIN,BOTTOM:OUTER_MARGIN,LEFT:OUTER_MARGIN},LAYOUT_INTERATIONS=32,REFRESH_INTERVAL=7E3,SERRCH_WORD="",mapLevelArray=[{id:"title",name:"\u5730\u56fe\u5c42\u7ea7"},{id:"0",name:"&emsp;\u6570\u636e\u533a"},{id:"1",name:"&emsp;&emsp;\u7cfb\u7edf"},{id:"2",name:"&emsp;&emsp;&emsp;\u8868"},{id:"3",name:"&emsp;&emsp;\u5b57\u6bb5"}];
function addBihiSankey(d,f,g,h){function m(c){return{w:Math.round(d3.select(c).style("width").split("px")[0]),h:Math.round(d3.select(c).style("height").split("px")[0])}}function z(){function l(a){a.children.forEach(function(a){a.state="contained";a.parent=this;a._parent=null;l(a)},a)}function f(a){a.state="expanded";a.children.forEach(function(a){a.state="collapsed";a._parent=this;a.parent=null;l(a)},a)}function g(){J.classed("sel",!1);A.style("stroke",q).style("marker-end",function(){return"url(#arrowHead)"}).transition().duration(TRANSITION_DURATION).style("stroke-opacity",
OPACITY.LINK_DEFAULT);B.selectAll("rect").style("fill",q);B.filter(function(a){return"collapsed"===a.state}).transition().duration(TRANSITION_DURATION).style("opacity",OPACITY.NODE_DEFAULT)}function h(a){d3.event.defaultPrevented||(console.log("click:"+a),g(),"expanded"!==a.state&&(I(a),m(a)),"#chart"===d&&onGetNodeInfo(a))}function k(a){c(2*TRANSITION_DURATION);H();if(!a.children||0==a.children.length)return!1;"collapsed"===a.state?f(a):(a.state="collapsed",l(a));e.relayout();z();A.attr("d",E);g()}
function m(a){function b(a){d3.select("g.node[data-id='"+a.id+"']").transition().duration(TRANSITION_DURATION).style("opacity",OPACITY.NODE_DEFAULT).select("rect").style("fill",function(a){return q(a,"high")}).style("fill-opacity",OPACITY.NODE_HIGHLIGHT);if(0<a.rightLinks.filter(function(a){return"collapsed"===a.target.state}).filter(function(a){return"HIGH"!==a.state}).length)return!1;var n=A.filter(function(b){return b.target===a});n.style("marker-end",function(){return"url(#arrowHeadInflow)"}).transition().duration(TRANSITION_DURATION).style("stroke",
function(a){a.state="HIGH";return q(a.source,"high")}).style("stroke-opacity",OPACITY.LINK_HIGHLIGHT);n.each(function(a){b(a.source)})}function n(a){d3.select("g.node[data-id='"+a.id+"']").transition().duration(TRANSITION_DURATION).style("opacity",OPACITY.NODE_DEFAULT).select("rect").style("fill",function(a){return q(a,"high")}).style("fill-opacity",OPACITY.NODE_HIGHLIGHT);if(0<a.leftLinks.filter(function(a){return"collapsed"===a.source.state}).filter(function(a){return"HIGH"!==a.state}).length)return!1;
var b=A.filter(function(b){return b.source===a});b.style("marker-end",function(){return"url(#arrowHeadOutlow)"}).transition().duration(TRANSITION_DURATION).style("stroke",function(a){a.state="HIGH";return q(a.source,"high")}).style("stroke-opacity",OPACITY.LINK_HIGHLIGHT);b.each(function(a){n(a.target)})}J.filter(function(b){return b===a}).classed("sel",!0);d3.select("g.node[data-id='"+a.id+"']").transition().duration(TRANSITION_DURATION).style("opacity",OPACITY.NODE_DEFAULT).select("rect").style("fill",
function(a){return q(a,"high")}).style("fill-opacity",OPACITY.NODE_HIGHLIGHT);A.filter(function(b){return b.source===a}).style("marker-end",function(){return"url(#arrowHeadInflow)"}).transition().duration(TRANSITION_DURATION).style("stroke",function(a){a.state="HIGH";return q(a.source,"high")}).style("stroke-opacity",OPACITY.LINK_HIGHLIGHT);A.filter(function(b){return b.target===a}).style("marker-end",function(){return"url(#arrowHeadOutlow)"}).transition().duration(TRANSITION_DURATION).style("stroke",
function(a){a.state="HIGH";return q(a.source,"high")}).style("stroke-opacity",OPACITY.LINK_HIGHLIGHT);b(a);n(a)}function I(a){A.filter(function(b){return b.source!==a&&b.target!==a}).style("marker-end",function(){return"url(#arrowHead)"}).transition().duration(TRANSITION_DURATION).style("stroke-opacity",OPACITY.LINK_FADED);B.filter(function(b){return b.id===a.id?!1:!e.connected(b,a)}).transition().duration(TRANSITION_DURATION).style("opacity",OPACITY.NODE_FADED)}function q(a,b){var n,c=a;a.direction&&
(a.state="NORMAL",c=a.source);n=b&&"high"==b?F(c.type.replace(/ .*/,"")):G(c.type.replace(/ .*/,""));c._parent&&c._parent.childMaxY&&(1==c.slevel?n=d3.rgb(n).brighter((c.py+1)/c._parent.childMaxY*.5):1<c.slevel&&(n=c._parent.color));a.direction||(c.color=n);return n}function v(a){p||D.style("left",d3.mouse($(d3.event.target).parents(".chart-container")[0])[0]+10+"px").style("top",d3.mouse($(d3.event.target).parents(".chart-container")[0])[1]+15+"px").transition().duration(TRANSITION_DURATION).style("opacity",
1).select(".value").text(function(){return a.name+(a.children.length?"expanded"===a.state?"(\u53cc\u51fb\u8fd4\u56de)":"(\u53cc\u51fb\u5c55\u5f00)":"")})}function b(a){p||D.style("left",d3.mouse($(d3.event.target).parents(".chart-container")[0])[0]+10+"px").style("top",d3.mouse($(d3.event.target).parents(".chart-container")[0])[1]+15+"px").transition().duration(TRANSITION_DURATION).style("opacity",1).select(".value").text(function(){return 0<a.direction?a.source.name+" \u2192 "+a.target.name:dg.target.name+
" \u2190 "+a.source.name})}function w(){p||D.style("left",d3.mouse($(d3.event.target).parents(".chart-container")[0])[0]+10+"px").style("top",d3.mouse($(d3.event.target).parents(".chart-container")[0])[1]+15+"px")}var a,A,B,t,y,J;a=x.select("#nodes").selectAll(".node").data(e.collapsedNodes(),function(a){return a.id});a.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).style("opacity",OPACITY.NODE_DEFAULT).select("rect").style("opacity",OPACITY.NODE_HIGHLIGHT).style("fill",q).attr("height",
function(a){return a.height}).attr("width",function(a){return a.width});a.select("text").attr("fill",function(){return TEXT_NORMAL_COLOR});a.exit().attr("transform",function(a){var b;b=a.ancestors.filter(function(a){return"collapsed"===a.state})[0];return"translate("+(b?b.x:a.x)+","+(b?b.y:a.y)+")"}).remove();B=a.enter().append("g").attr("class","node").attr("data-id",function(a){return a.id?a.id:"root"});B.attr("transform",function(a){return"translate("+(a._parent?a._parent.x:a.parent?a.parent.x:
a.x)+","+(a._parent?a._parent.y:a.parent?a.parent.y:a.y)+")"}).style("opacity",1E-6).style("opacity",OPACITY.NODE_DEFAULT).attr("transform",function(a){return"translate("+a.x+","+a.y+")"});B.append("rect").style("fill",q).attr("height",function(a){return a.height}).attr("width",function(a){return a.width}).attr("rx",function(a){return d3.min([a.width,a.height])/20}).attr("ry",function(a){return d3.min([a.width,a.height])/20}).filter(function(a){return 1==a.slevel});B.append("text");B.filter(function(a){return 0!==
a.height}).select("text").attr("x",function(a){return a.width/2}).attr("y",function(a){return a.height/2}).attr("font-size",function(a){var b=d3.zoomTransform($("svg.bihi-svg")[0]);return TEXT_BIG_SIZE[a.slevel]/b.k}).attr("fill",function(a){return TEXT_NORMAL_COLOR}).attr("dy",".35em").attr("text-anchor","middle").attr("transform",null).text(function(a){return a.name});B=B.merge(a);a=x.select("#expandNodes").selectAll(".node").data(e.expandedNodes(),function(a){return a.id});a.attr("transform",function(a){return"translate("+
a.x+","+a.y+")"}).select("rect").style("opacity",OPACITY.NODE_FADED).style("fill",q).style("stroke",function(a){return d3.rgb(G(a.type.replace(/ .*/,""))).darker(.1)}).style("stroke-width","1px").attr("height",function(a){return a.height}).attr("width",function(a){return a.width});a.select("text").attr("text-anchor","middle ").attr("x",function(a){return a.width/2}).attr("y",0).attr("fill",function(a){return a.color}).style("opacity",OPACITY.NODE_DEFAULT);a.exit().remove();t=a.enter().append("g").attr("class",
"node").attr("data-id",function(a){return a.id?a.id:"root"});t.attr("transform",function(a){return"translate("+(a._parent?a._parent.x:a.parent?a.parent.x:a.x)+","+(a._parent?a._parent.y:a.parent?a.parent.y:a.y)+")"}).transition().duration(TRANSITION_DURATION).attr("transform",function(a){return"translate("+a.x+","+a.y+")"});t.append("rect").style("opacity",OPACITY.NODE_FADED).style("fill",q).style("stroke",function(a){return d3.rgb(G(a.type.replace(/ .*/,""))).darker(.1)}).style("stroke-width","2px").attr("height",
function(a){return a.height}).attr("width",function(a){return a.width}).attr("rx",function(a){return d3.min([a.width,a.height])/20}).attr("ry",function(a){return d3.min([a.width,a.height])/20}).filter(function(a){return 1==a.slevel});t.append("text");t.filter(function(a){return 0!==a.value}).select("text").attr("text-anchor","middle ").attr("x",function(a){return a.width/2}).attr("y",0).attr("fill",function(a){return a.color}).style("opacity",OPACITY.NODE_DEFAULT).text(function(a){return a.name});
t=t.merge(a);B.on("mouseenter",function(a){v(a)});B.on("mousemove",function(){w()});B.on("mouseleave",function(){p||H()});B.on("dblclick",k).on("mousedown",h);t.on("mouseenter",function(a){v(a)});t.on("mousemove",function(){w()});t.on("mouseleave",function(){p||H()});t.on("dblclick",k).on("mousedown",h);a=x.select("#links").selectAll("path.link").data(e.visibleLinks(),function(a){return a.id});a.style("stroke-width",function(a){return Math.max(1,a.thickness)}).attr("d",E);a.exit().remove();A=a.enter().append("path").attr("class",
"link").style("fill","none");A.sort(function(a,b){return b.thickness-a.thickness}).classed("leftToRight",function(a){return 0<a.direction}).classed("rightToLeft",function(a){return 0>a.direction}).style("marker-end",function(){return"url(#arrowHead)"}).style("stroke",function(a){return 0<a.direction?G(a.source.type.replace(/ .*/,"")):G(a.target.type.replace(/ .*/,""))}).style("stroke-width",function(a){return Math.max(1,a.thickness)}).style("stroke-opacity",OPACITY.LINK_FADED).transition().delay(TRANSITION_DURATION).duration(TRANSITION_DURATION).attr("d",
E).style("stroke-opacity",OPACITY.LINK_DEFAULT);A=A.merge(a);A.on("mouseenter",function(a){b(a)});A.on("mousemove",function(){w()});A.on("mouseleave",function(){p||H()});y=C.select(".nodeListContainer");a=y.selectAll(".node-item").data(e.showListNodes(),function(a){return a.id});a.classed("node-item-p",function(a){return"expanded"==a.state?!0:!1});a.exit().remove();J=a.enter().append("div").attr("class",function(a){return"node-item node-item-"+a.slevel+""}).attr("data-id",function(a){return a.id});
J.append("span").attr("class","item-ico").style("background-color",function(a){return a.color});J.append("span").attr("class","item-text").attr("title",function(a){return a.name}).text(function(a){if(a.parent||a._parent){var b=a.parent?a.parent.id:a._parent.id;y.select('.node-item[data-id="'+b+'"]').classed("node-item-p",!0);b=$(this).parents(".nodeListContainer").find('.node-item[data-id="'+b+'"]');$($(this).parents(".node-item")[0]).insertAfter(b)}return a.name});J=J.merge(a);J.on("click",h).on("dblclick",
k);$(u.node()).on("mousedown",function(a){$(a.target).closest(".node").length||g()})}var v=d3.select(d);v.selectAll("div.chart-left").remove();v.selectAll("div.chart-body").remove();v.selectAll("div#tooltip").remove();v.selectAll("div#mapLevel").remove();var C=v.append("div").attr("class","chart-left"),t=v.append("div").attr("class","chart-body"),u,x,D,e,E,G,F,p;C.append("div").html('<div class="items-list-content"><div class="items-list-title">\u6570\u636e\u76ee\u5f55</div><div class="search-site clearfix" class = "inputSearchC"><input class="search-name" type="text"><label></label></div></div><div class="nodeListContainer"><div class="items-lists"><div class="item"><ul class="itemCotent"><li><span class="item-ico item-ico-hudColor"></span><span class="item-text">\u5355\u7ebf\u6d41\u5411</span></li><li><span class="item-ico item-ico-hud"></span><span class="item-text">\u5bf9\u5bf9\u5bf9\u6d41\u5411</span></li></ul></div></div></div>');
$(d).find(".nodeListContainer").css("height",C.node().getBoundingClientRect().height-C.select(".items-list-content").node().getBoundingClientRect().height-10);var y=$(d+" .chart-left").width(),w=m(d).w-MARGIN.LEFT-MARGIN.RIGHT-y,k=m(d).h-MARGIN.TOP-MARGIN.BOTTOM,c=function(c){p=!0;setTimeout(function(){p=!1},c)},H=function(){return D.transition().duration(TRANSITION_DURATION).style("opacity",0)},l=d3.zoom().scaleExtent([ZOOM_MIN,ZOOM_MAX]).on("zoom",function(){H();var c=d3.zoomTransform(this);x.attr("transform",
d3.zoomTransform(this));d3.selectAll("text").attr("font-size",function(d){return TEXT_BIG_SIZE[d.slevel]/c.k});.4>c.k?d3.selectAll("g.node").filter(function(c){return 2<=c.slevel}).selectAll("text").transition().duration(5*TRANSITION_DURATION).style("opacity",0):d3.selectAll("g.node").filter(function(c){return 2<=c.slevel}).selectAll("text").transition().duration(5*TRANSITION_DURATION).style("opacity",1)});G=d3.scaleOrdinal().domain(TYPES).range(TYPE_COLORS);F=d3.scaleOrdinal().domain(TYPES).range(TYPE_HIGHLIGHT_COLORS);
u=t.append("svg").attr("class","bihi-svg").attr("width",w+MARGIN.LEFT+MARGIN.RIGHT).attr("height",k+MARGIN.TOP+MARGIN.BOTTOM);x=u.append("g").attr("transform","translate("+MARGIN.LEFT+","+MARGIN.TOP+")");x.append("g").attr("id","expandNodes");x.append("g").attr("id","links");x.append("g").attr("id","nodes");D=v.append("div").attr("id","tooltip");D.style("opacity",0).append("p").attr("class","value");if("#chart"===d){v=v.append("div").attr("id","mapLevel").attr("class","mapLevel");t=v.append("svg").attr("width",
100).attr("height",160);t.append("rect").style("opacity",.3).style("fill","gray").attr("height",130).attr("width",8).attr("x",75).attr("y",35);var I=t.append("polygon").attr("fill","snow").attr("stroke","gray").attr("stroke-miterlimit","10").attr("stroke-width","1").attr("points","12,15 35,15 35,30 12,30 1,22.5").attr("transform","translate(56,"+(25+(h?34*h:0))+")");h=v.append("div").attr("class","map-Level-btn-c").selectAll(".level-item").data(mapLevelArray,function(c){return c.id});h.exit().remove();
h=h.enter().append("div").attr("class",function(c){return"level-item level-item-"+c.id+""}).attr("data-levelId",function(c){return c.id});h.append("span").html(function(c){return c.name});h.on("click",function(c){console.log("mapLevelEnter"+c);I.transition().duration(TRANSITION_DURATION).attr("transform","translate(56,"+(25+34*c.id)+")");setTimeout(function(){if(useLocalStorageData&&getRetData("overView"+c.id)){var d=eval("("+getRetData("overView"+c.id)+")");addBihiSankey("#chart",d,"collapsed",c.id);
return!0}$.ajax({url:"overView/"+c.id,success:function(d){saveRetData("overView"+c.id,d);d=eval("("+d+")");addBihiSankey("#chart",d,"collapsed",c.id)},error:function(c,d,e){alert(c.status);alert(c.readyState);alert(d)}})},TRANSITION_DURATION)})}e=d3.biHiSankey();e.nodeSpacing(10).linkSpacing(4).arrowheadScaleFactor(.5).size([w,k]);E=e.link().curvature(.35);h=x.append("defs");h.append("marker").style("fill",LINK_COLOR).attr("id","arrowHead").attr("viewBox","0 0 6 10").attr("refX","1").attr("refY",
"5").attr("markerUnits","strokeWidth").attr("markerWidth","1").attr("markerHeight","1").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");h.append("marker").style("fill",OUTFLOW_COLOR).attr("id","arrowHeadInflow").attr("viewBox","0 0 6 10").attr("refX","1").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","1").attr("markerHeight","1").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");h.append("marker").style("fill",
INFLOW_COLOR).attr("id","arrowHeadOutlow").attr("viewBox","0 0 6 10").attr("refX","1").attr("refY","5").attr("markerUnits","strokeWidth").attr("markerWidth","1").attr("markerHeight","1").attr("orient","auto").append("path").attr("d","M 0 0 L 1 0 L 6 5 L 1 10 L 0 10 z");e.nodes(f.nodes).links(f.links).initializeNodes(function(c){c.state="expanded"==g?0<c.children.length?"expanded":"collapsed":c.parent?"contained":"collapsed"}).layout(LAYOUT_INTERATIONS);c(2*TRANSITION_DURATION);z();f=.8*w/Math.round(u.select("g").node().getBoundingClientRect().width);
h=.8*k/Math.round(u.select("g").node().getBoundingClientRect().height);f=d3.min([ZOOM_MIN,d3.min([f,h])]);l.scaleExtent([f,ZOOM_MAX]);w=(w/2-Math.round(u.select("g").node().getBoundingClientRect().width*f/2))/f;k=(k/2-Math.round(u.select("g").node().getBoundingClientRect().height*f/2))/f;(function(c,d,e,f){u.transition().duration(f).call(l.transform,d3.zoomIdentity.scale(c).translate(d,e)).on("end",function(){u.call(l).on("dblclick.zoom",null)})})(f,w,k,1E3);$(window).resize(function(){u.attr("width",
m(d).w-y).attr("height",m(d).h)})}
(function(){function d(d,g){return 1E-10>Math.abs(d-g)}"undefined"==typeof geo&&(geo={});geo.eq=d;geo.gt=function(d,g){return-1E-10<d-g};geo.lt=function(d,g){return-1E-10<g-d};geo.LineSegment=function(f,g,h,m){this.x1=f;this.y1=g;this.x2=h;this.y2=m;this.a=m-g;this.b=f-h;this.c=f*this.a+g*this.b;if(d(this.a,0)&&d(this.b,0))throw Error("Cannot construct a LineSegment with two equal endpoints.");};geo.LineSegment.prototype.intersect=function(f){var g=(this.x1-this.x2)*(f.y1-f.y2)-(this.y1-this.y2)*
(f.x1-f.x2);if(d(g,0))return{x:NaN,y:NaN};var h=this.x1*this.y2-this.y1*this.x2,m=f.x1*f.y2-f.y1*f.x2,z=(h*(f.x1-f.x2)-m*(this.x1-this.x2))/g,g=(h*(f.y1-f.y2)-m*(this.y1-this.y2))/g;return{x:z,y:g,in1:-1E-10<z-Math.min(this.x1,this.x2)&&-1E-10<Math.max(this.x1,this.x2)-z&&-1E-10<g-Math.min(this.y1,this.y2)&&-1E-10<Math.max(this.y1,this.y2)-g,in2:-1E-10<z-Math.min(f.x1,f.x2)&&-1E-10<Math.max(f.x1,f.x2)-z&&-1E-10<g-Math.min(f.y1,f.y2)&&-1E-10<Math.max(f.y1,f.y2)-g}};geo.LineSegment.prototype.x=function(d){return this.a?
(this.c-this.b*d)/this.a:NaN};geo.LineSegment.prototype.y=function(d){return this.b?(this.c-this.a*d)/this.b:NaN};geo.LineSegment.prototype.length=function(){return Math.sqrt((this.y2-this.y1)*(this.y2-this.y1)+(this.x2-this.x1)*(this.x2-this.x1))};geo.LineSegment.prototype.offset=function(d,g){return new geo.LineSegment(this.x1+d,this.y1+g,this.x2+d,this.y2+g)}})();
var colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:"#ffffcc #d9f0a3 #addd8e #78c679 #31a354 #006837".split(" "),7:"#ffffcc #d9f0a3 #addd8e #78c679 #41ab5d #238443 #005a32".split(" "),8:"#ffffe5 #f7fcb9 #d9f0a3 #addd8e #78c679 #41ab5d #238443 #005a32".split(" "),9:"#ffffe5 #f7fcb9 #d9f0a3 #addd8e #78c679 #41ab5d #238443 #006837 #004529".split(" ")},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc",
"#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:"#ffffcc #c7e9b4 #7fcdbb #41b6c4 #2c7fb8 #253494".split(" "),7:"#ffffcc #c7e9b4 #7fcdbb #41b6c4 #1d91c0 #225ea8 #0c2c84".split(" "),8:"#ffffd9 #edf8b1 #c7e9b4 #7fcdbb #41b6c4 #1d91c0 #225ea8 #0c2c84".split(" "),9:"#ffffd9 #edf8b1 #c7e9b4 #7fcdbb #41b6c4 #1d91c0 #225ea8 #253494 #081d58".split(" ")},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4",
"#43a2ca","#0868ac"],6:"#f0f9e8 #ccebc5 #a8ddb5 #7bccc4 #43a2ca #0868ac".split(" "),7:"#f0f9e8 #ccebc5 #a8ddb5 #7bccc4 #4eb3d3 #2b8cbe #08589e".split(" "),8:"#f7fcf0 #e0f3db #ccebc5 #a8ddb5 #7bccc4 #4eb3d3 #2b8cbe #08589e".split(" "),9:"#f7fcf0 #e0f3db #ccebc5 #a8ddb5 #7bccc4 #4eb3d3 #2b8cbe #0868ac #084081".split(" ")},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:"#edf8fb #ccece6 #99d8c9 #66c2a4 #2ca25f #006d2c".split(" "),
7:"#edf8fb #ccece6 #99d8c9 #66c2a4 #41ae76 #238b45 #005824".split(" "),8:"#f7fcfd #e5f5f9 #ccece6 #99d8c9 #66c2a4 #41ae76 #238b45 #005824".split(" "),9:"#f7fcfd #e5f5f9 #ccece6 #99d8c9 #66c2a4 #41ae76 #238b45 #006d2c #00441b".split(" ")},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:"#f6eff7 #d0d1e6 #a6bddb #67a9cf #1c9099 #016c59".split(" "),7:"#f6eff7 #d0d1e6 #a6bddb #67a9cf #3690c0 #02818a #016450".split(" "),
8:"#fff7fb #ece2f0 #d0d1e6 #a6bddb #67a9cf #3690c0 #02818a #016450".split(" "),9:"#fff7fb #ece2f0 #d0d1e6 #a6bddb #67a9cf #3690c0 #02818a #016c59 #014636".split(" ")},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:"#f1eef6 #d0d1e6 #a6bddb #74a9cf #2b8cbe #045a8d".split(" "),7:"#f1eef6 #d0d1e6 #a6bddb #74a9cf #3690c0 #0570b0 #034e7b".split(" "),8:"#fff7fb #ece7f2 #d0d1e6 #a6bddb #74a9cf #3690c0 #0570b0 #034e7b".split(" "),
9:"#fff7fb #ece7f2 #d0d1e6 #a6bddb #74a9cf #3690c0 #0570b0 #045a8d #023858".split(" ")},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:"#edf8fb #bfd3e6 #9ebcda #8c96c6 #8856a7 #810f7c".split(" "),7:"#edf8fb #bfd3e6 #9ebcda #8c96c6 #8c6bb1 #88419d #6e016b".split(" "),8:"#f7fcfd #e0ecf4 #bfd3e6 #9ebcda #8c96c6 #8c6bb1 #88419d #6e016b".split(" "),9:"#f7fcfd #e0ecf4 #bfd3e6 #9ebcda #8c96c6 #8c6bb1 #88419d #810f7c #4d004b".split(" ")},
RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:"#feebe2 #fcc5c0 #fa9fb5 #f768a1 #c51b8a #7a0177".split(" "),7:"#feebe2 #fcc5c0 #fa9fb5 #f768a1 #dd3497 #ae017e #7a0177".split(" "),8:"#fff7f3 #fde0dd #fcc5c0 #fa9fb5 #f768a1 #dd3497 #ae017e #7a0177".split(" "),9:"#fff7f3 #fde0dd #fcc5c0 #fa9fb5 #f768a1 #dd3497 #ae017e #7a0177 #49006a".split(" ")},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8",
"#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:"#f1eef6 #d4b9da #c994c7 #df65b0 #dd1c77 #980043".split(" "),7:"#f1eef6 #d4b9da #c994c7 #df65b0 #e7298a #ce1256 #91003f".split(" "),8:"#f7f4f9 #e7e1ef #d4b9da #c994c7 #df65b0 #e7298a #ce1256 #91003f".split(" "),9:"#f7f4f9 #e7e1ef #d4b9da #c994c7 #df65b0 #e7298a #ce1256 #980043 #67001f".split(" ")},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33",
"#b30000"],6:"#fef0d9 #fdd49e #fdbb84 #fc8d59 #e34a33 #b30000".split(" "),7:"#fef0d9 #fdd49e #fdbb84 #fc8d59 #ef6548 #d7301f #990000".split(" "),8:"#fff7ec #fee8c8 #fdd49e #fdbb84 #fc8d59 #ef6548 #d7301f #990000".split(" "),9:"#fff7ec #fee8c8 #fdd49e #fdbb84 #fc8d59 #ef6548 #d7301f #b30000 #7f0000".split(" ")},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:"#ffffb2 #fed976 #feb24c #fd8d3c #f03b20 #bd0026".split(" "),
7:"#ffffb2 #fed976 #feb24c #fd8d3c #fc4e2a #e31a1c #b10026".split(" "),8:"#ffffcc #ffeda0 #fed976 #feb24c #fd8d3c #fc4e2a #e31a1c #b10026".split(" "),9:"#ffffcc #ffeda0 #fed976 #feb24c #fd8d3c #fc4e2a #e31a1c #bd0026 #800026".split(" ")},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:"#ffffd4 #fee391 #fec44f #fe9929 #d95f0e #993404".split(" "),7:"#ffffd4 #fee391 #fec44f #fe9929 #ec7014 #cc4c02 #8c2d04".split(" "),
8:"#ffffe5 #fff7bc #fee391 #fec44f #fe9929 #ec7014 #cc4c02 #8c2d04".split(" "),9:"#ffffe5 #fff7bc #fee391 #fec44f #fe9929 #ec7014 #cc4c02 #993404 #662506".split(" ")},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:"#f2f0f7 #dadaeb #bcbddc #9e9ac8 #756bb1 #54278f".split(" "),7:"#f2f0f7 #dadaeb #bcbddc #9e9ac8 #807dba #6a51a3 #4a1486".split(" "),8:"#fcfbfd #efedf5 #dadaeb #bcbddc #9e9ac8 #807dba #6a51a3 #4a1486".split(" "),
9:"#fcfbfd #efedf5 #dadaeb #bcbddc #9e9ac8 #807dba #6a51a3 #54278f #3f007d".split(" ")},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:"#eff3ff #c6dbef #9ecae1 #6baed6 #3182bd #08519c".split(" "),7:"#eff3ff #c6dbef #9ecae1 #6baed6 #4292c6 #2171b5 #084594".split(" "),8:"#f7fbff #deebf7 #c6dbef #9ecae1 #6baed6 #4292c6 #2171b5 #084594".split(" "),9:"#f7fbff #deebf7 #c6dbef #9ecae1 #6baed6 #4292c6 #2171b5 #08519c #08306b".split(" ")},
Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:"#edf8e9 #c7e9c0 #a1d99b #74c476 #31a354 #006d2c".split(" "),7:"#edf8e9 #c7e9c0 #a1d99b #74c476 #41ab5d #238b45 #005a32".split(" "),8:"#f7fcf5 #e5f5e0 #c7e9c0 #a1d99b #74c476 #41ab5d #238b45 #005a32".split(" "),9:"#f7fcf5 #e5f5e0 #c7e9c0 #a1d99b #74c476 #41ab5d #238b45 #006d2c #00441b".split(" ")},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85",
"#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:"#feedde #fdd0a2 #fdae6b #fd8d3c #e6550d #a63603".split(" "),7:"#feedde #fdd0a2 #fdae6b #fd8d3c #f16913 #d94801 #8c2d04".split(" "),8:"#fff5eb #fee6ce #fdd0a2 #fdae6b #fd8d3c #f16913 #d94801 #8c2d04".split(" "),9:"#fff5eb #fee6ce #fdd0a2 #fdae6b #fd8d3c #f16913 #d94801 #a63603 #7f2704".split(" ")},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26",
"#a50f15"],6:"#fee5d9 #fcbba1 #fc9272 #fb6a4a #de2d26 #a50f15".split(" "),7:"#fee5d9 #fcbba1 #fc9272 #fb6a4a #ef3b2c #cb181d #99000d".split(" "),8:"#fff5f0 #fee0d2 #fcbba1 #fc9272 #fb6a4a #ef3b2c #cb181d #99000d".split(" "),9:"#fff5f0 #fee0d2 #fcbba1 #fc9272 #fb6a4a #ef3b2c #cb181d #a50f15 #67000d".split(" ")},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:"#f7f7f7 #d9d9d9 #bdbdbd #969696 #636363 #252525".split(" "),
7:"#f7f7f7 #d9d9d9 #bdbdbd #969696 #737373 #525252 #252525".split(" "),8:"#ffffff #f0f0f0 #d9d9d9 #bdbdbd #969696 #737373 #525252 #252525".split(" "),9:"#ffffff #f0f0f0 #d9d9d9 #bdbdbd #969696 #737373 #525252 #252525 #000000".split(" ")},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:"#b35806 #f1a340 #fee0b6 #d8daeb #998ec3 #542788".split(" "),7:"#b35806 #f1a340 #fee0b6 #f7f7f7 #d8daeb #998ec3 #542788".split(" "),
8:"#b35806 #e08214 #fdb863 #fee0b6 #d8daeb #b2abd2 #8073ac #542788".split(" "),9:"#b35806 #e08214 #fdb863 #fee0b6 #f7f7f7 #d8daeb #b2abd2 #8073ac #542788".split(" "),10:"#7f3b08 #b35806 #e08214 #fdb863 #fee0b6 #d8daeb #b2abd2 #8073ac #542788 #2d004b".split(" "),11:"#7f3b08 #b35806 #e08214 #fdb863 #fee0b6 #f7f7f7 #d8daeb #b2abd2 #8073ac #542788 #2d004b".split(" ")},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],
6:"#8c510a #d8b365 #f6e8c3 #c7eae5 #5ab4ac #01665e".split(" "),7:"#8c510a #d8b365 #f6e8c3 #f5f5f5 #c7eae5 #5ab4ac #01665e".split(" "),8:"#8c510a #bf812d #dfc27d #f6e8c3 #c7eae5 #80cdc1 #35978f #01665e".split(" "),9:"#8c510a #bf812d #dfc27d #f6e8c3 #f5f5f5 #c7eae5 #80cdc1 #35978f #01665e".split(" "),10:"#543005 #8c510a #bf812d #dfc27d #f6e8c3 #c7eae5 #80cdc1 #35978f #01665e #003c30".split(" "),11:"#543005 #8c510a #bf812d #dfc27d #f6e8c3 #f5f5f5 #c7eae5 #80cdc1 #35978f #01665e #003c30".split(" ")},
PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:"#762a83 #af8dc3 #e7d4e8 #d9f0d3 #7fbf7b #1b7837".split(" "),7:"#762a83 #af8dc3 #e7d4e8 #f7f7f7 #d9f0d3 #7fbf7b #1b7837".split(" "),8:"#762a83 #9970ab #c2a5cf #e7d4e8 #d9f0d3 #a6dba0 #5aae61 #1b7837".split(" "),9:"#762a83 #9970ab #c2a5cf #e7d4e8 #f7f7f7 #d9f0d3 #a6dba0 #5aae61 #1b7837".split(" "),10:"#40004b #762a83 #9970ab #c2a5cf #e7d4e8 #d9f0d3 #a6dba0 #5aae61 #1b7837 #00441b".split(" "),
11:"#40004b #762a83 #9970ab #c2a5cf #e7d4e8 #f7f7f7 #d9f0d3 #a6dba0 #5aae61 #1b7837 #00441b".split(" ")},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:"#c51b7d #e9a3c9 #fde0ef #e6f5d0 #a1d76a #4d9221".split(" "),7:"#c51b7d #e9a3c9 #fde0ef #f7f7f7 #e6f5d0 #a1d76a #4d9221".split(" "),8:"#c51b7d #de77ae #f1b6da #fde0ef #e6f5d0 #b8e186 #7fbc41 #4d9221".split(" "),9:"#c51b7d #de77ae #f1b6da #fde0ef #f7f7f7 #e6f5d0 #b8e186 #7fbc41 #4d9221".split(" "),
10:"#8e0152 #c51b7d #de77ae #f1b6da #fde0ef #e6f5d0 #b8e186 #7fbc41 #4d9221 #276419".split(" "),11:"#8e0152 #c51b7d #de77ae #f1b6da #fde0ef #f7f7f7 #e6f5d0 #b8e186 #7fbc41 #4d9221 #276419".split(" ")},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:"#b2182b #ef8a62 #fddbc7 #d1e5f0 #67a9cf #2166ac".split(" "),7:"#b2182b #ef8a62 #fddbc7 #f7f7f7 #d1e5f0 #67a9cf #2166ac".split(" "),8:"#b2182b #d6604d #f4a582 #fddbc7 #d1e5f0 #92c5de #4393c3 #2166ac".split(" "),
9:"#b2182b #d6604d #f4a582 #fddbc7 #f7f7f7 #d1e5f0 #92c5de #4393c3 #2166ac".split(" "),10:"#67001f #b2182b #d6604d #f4a582 #fddbc7 #d1e5f0 #92c5de #4393c3 #2166ac #053061".split(" "),11:"#67001f #b2182b #d6604d #f4a582 #fddbc7 #f7f7f7 #d1e5f0 #92c5de #4393c3 #2166ac #053061".split(" ")},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:"#b2182b #ef8a62 #fddbc7 #e0e0e0 #999999 #4d4d4d".split(" "),7:"#b2182b #ef8a62 #fddbc7 #ffffff #e0e0e0 #999999 #4d4d4d".split(" "),
8:"#b2182b #d6604d #f4a582 #fddbc7 #e0e0e0 #bababa #878787 #4d4d4d".split(" "),9:"#b2182b #d6604d #f4a582 #fddbc7 #ffffff #e0e0e0 #bababa #878787 #4d4d4d".split(" "),10:"#67001f #b2182b #d6604d #f4a582 #fddbc7 #e0e0e0 #bababa #878787 #4d4d4d #1a1a1a".split(" "),11:"#67001f #b2182b #d6604d #f4a582 #fddbc7 #ffffff #e0e0e0 #bababa #878787 #4d4d4d #1a1a1a".split(" ")},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],
6:"#d73027 #fc8d59 #fee090 #e0f3f8 #91bfdb #4575b4".split(" "),7:"#d73027 #fc8d59 #fee090 #ffffbf #e0f3f8 #91bfdb #4575b4".split(" "),8:"#d73027 #f46d43 #fdae61 #fee090 #e0f3f8 #abd9e9 #74add1 #4575b4".split(" "),9:"#d73027 #f46d43 #fdae61 #fee090 #ffffbf #e0f3f8 #abd9e9 #74add1 #4575b4".split(" "),10:"#a50026 #d73027 #f46d43 #fdae61 #fee090 #e0f3f8 #abd9e9 #74add1 #4575b4 #313695".split(" "),11:"#a50026 #d73027 #f46d43 #fdae61 #fee090 #ffffbf #e0f3f8 #abd9e9 #74add1 #4575b4 #313695".split(" ")},
Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:"#d53e4f #fc8d59 #fee08b #e6f598 #99d594 #3288bd".split(" "),7:"#d53e4f #fc8d59 #fee08b #ffffbf #e6f598 #99d594 #3288bd".split(" "),8:"#d53e4f #f46d43 #fdae61 #fee08b #e6f598 #abdda4 #66c2a5 #3288bd".split(" "),9:"#d53e4f #f46d43 #fdae61 #fee08b #ffffbf #e6f598 #abdda4 #66c2a5 #3288bd".split(" "),10:"#9e0142 #d53e4f #f46d43 #fdae61 #fee08b #e6f598 #abdda4 #66c2a5 #3288bd #5e4fa2".split(" "),
11:"#9e0142 #d53e4f #f46d43 #fdae61 #fee08b #ffffbf #e6f598 #abdda4 #66c2a5 #3288bd #5e4fa2".split(" ")},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:"#d73027 #fc8d59 #fee08b #d9ef8b #91cf60 #1a9850".split(" "),7:"#d73027 #fc8d59 #fee08b #ffffbf #d9ef8b #91cf60 #1a9850".split(" "),8:"#d73027 #f46d43 #fdae61 #fee08b #d9ef8b #a6d96a #66bd63 #1a9850".split(" "),9:"#d73027 #f46d43 #fdae61 #fee08b #ffffbf #d9ef8b #a6d96a #66bd63 #1a9850".split(" "),
10:"#a50026 #d73027 #f46d43 #fdae61 #fee08b #d9ef8b #a6d96a #66bd63 #1a9850 #006837".split(" "),11:"#a50026 #d73027 #f46d43 #fdae61 #fee08b #ffffbf #d9ef8b #a6d96a #66bd63 #1a9850 #006837".split(" ")},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:"#7fc97f #beaed4 #fdc086 #ffff99 #386cb0 #f0027f".split(" "),7:"#7fc97f #beaed4 #fdc086 #ffff99 #386cb0 #f0027f #bf5b17".split(" "),8:"#7fc97f #beaed4 #fdc086 #ffff99 #386cb0 #f0027f #bf5b17 #666666".split(" ")},
Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:"#1b9e77 #d95f02 #7570b3 #e7298a #66a61e #e6ab02".split(" "),7:"#1b9e77 #d95f02 #7570b3 #e7298a #66a61e #e6ab02 #a6761d".split(" "),8:"#1b9e77 #d95f02 #7570b3 #e7298a #66a61e #e6ab02 #a6761d #666666".split(" ")},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c".split(" "),
7:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c #fdbf6f".split(" "),8:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c #fdbf6f #ff7f00".split(" "),9:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c #fdbf6f #ff7f00 #cab2d6".split(" "),10:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c #fdbf6f #ff7f00 #cab2d6 #6a3d9a".split(" "),11:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c #fdbf6f #ff7f00 #cab2d6 #6a3d9a #ffff99".split(" "),12:"#a6cee3 #1f78b4 #b2df8a #33a02c #fb9a99 #e31a1c #fdbf6f #ff7f00 #cab2d6 #6a3d9a #ffff99 #b15928".split(" ")},
Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:"#fbb4ae #b3cde3 #ccebc5 #decbe4 #fed9a6 #ffffcc".split(" "),7:"#fbb4ae #b3cde3 #ccebc5 #decbe4 #fed9a6 #ffffcc #e5d8bd".split(" "),8:"#fbb4ae #b3cde3 #ccebc5 #decbe4 #fed9a6 #ffffcc #e5d8bd #fddaec".split(" "),9:"#fbb4ae #b3cde3 #ccebc5 #decbe4 #fed9a6 #ffffcc #e5d8bd #fddaec #f2f2f2".split(" ")},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac",
"#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:"#b3e2cd #fdcdac #cbd5e8 #f4cae4 #e6f5c9 #fff2ae".split(" "),7:"#b3e2cd #fdcdac #cbd5e8 #f4cae4 #e6f5c9 #fff2ae #f1e2cc".split(" "),8:"#b3e2cd #fdcdac #cbd5e8 #f4cae4 #e6f5c9 #fff2ae #f1e2cc #cccccc".split(" ")},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:"#e41a1c #377eb8 #4daf4a #984ea3 #ff7f00 #ffff33".split(" "),7:"#e41a1c #377eb8 #4daf4a #984ea3 #ff7f00 #ffff33 #a65628".split(" "),
8:"#e41a1c #377eb8 #4daf4a #984ea3 #ff7f00 #ffff33 #a65628 #f781bf".split(" "),9:"#e41a1c #377eb8 #4daf4a #984ea3 #ff7f00 #ffff33 #a65628 #f781bf #999999".split(" ")},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:"#66c2a5 #fc8d62 #8da0cb #e78ac3 #a6d854 #ffd92f".split(" "),7:"#66c2a5 #fc8d62 #8da0cb #e78ac3 #a6d854 #ffd92f #e5c494".split(" "),8:"#66c2a5 #fc8d62 #8da0cb #e78ac3 #a6d854 #ffd92f #e5c494 #b3b3b3".split(" ")},
Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462".split(" "),7:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462 #b3de69".split(" "),8:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462 #b3de69 #fccde5".split(" "),9:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462 #b3de69 #fccde5 #d9d9d9".split(" "),10:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462 #b3de69 #fccde5 #d9d9d9 #bc80bd".split(" "),
11:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462 #b3de69 #fccde5 #d9d9d9 #bc80bd #ccebc5".split(" "),12:"#8dd3c7 #ffffb3 #bebada #fb8072 #80b1d3 #fdb462 #b3de69 #fccde5 #d9d9d9 #bc80bd #ccebc5 #ffed6f".split(" ")}},addForceLay=function(d,f){function g(c){return d3.scaleOrdinal().domain(e.categoryKeys).range(e.colors.map(function(d){return d3.hsl(d).darker(c).toString()}))}function h(c){if(26>=c.length)return[c];for(var d=0;d<k.length;d++)for(var e=k[d],f=26;0<=f;f--)if(c.charAt(f)===e)return[c.substring(0,
f+1)].concat(h(c.substring(f+1)));return[c.substring(0,26)].concat(h(c.substring(26)))}function m(c){c.fx=d3.event.x;c.fy=d3.event.y}function z(c,d){if(!d3.event.defaultPrevented){var l;d?l=d3.select(d):e.node.each(function(e){e===c&&(l=d3.select(d=this))});l&&(l.classed("selected")?v():(v(!1),C(c),l.classed("selected",!0)))}}function v(c){(c||"undefined"==typeof c)&&resize(!1);e.node.classed("selected",!1);C(null)}function C(c){c?(c!==E&&(e.node.classed("inactive",function(d){return c!==d&&-1==d.depends.indexOf(c.id)&&
-1==d.dependedOnBy.indexOf(c.id)}),e.line.classed("inactive",function(d){return c!==d.source&&c!==d.target})),E=c):(E&&(e.node.classed("inactive",!1),e.line.classed("inactive",!1)),E=null)}var t={group0:{"short":"Group 0","long":"Group 0 long name for docs"},group1:{"short":"Group 1","long":"Group 1 long name for docs"},group2:{"short":"Group 2","long":"Group 2 long name for docs"},group3:{"short":"Group 3","long":"Group 3 long name for docs"},group4:{"short":"Group 4","long":"Group 4 long name for docs"},
group5:{"short":"Group 5","long":"Group 5 long name for docs"},group6:{"short":"Group 6","long":"Group 6 long name for docs"},group7:{"short":"Group 7","long":"Group 7 long name for docs"},group8:{"short":"Group 8","long":"Group 8 long name for docs"},group9:{"short":"Group 9","long":"Group 9 long name for docs"},group10:{"short":"Group 10","long":"Group 10 long name for docs"}},u=[{has:{metadata:"group1"},metadata:"position",x:.2,y:.2,weight:.7},{has:{metadata:"group2"},metadata:"position",x:.8,
y:.2,weight:.7},{has:{metadata:"group3"},metadata:"position",x:.2,y:.5,weight:.7},{has:{metadata:"group4"},metadata:"position",x:.8,y:.5,weight:.7},{has:{metadata:"group5"},metadata:"position",x:.2,y:.8,weight:.7},{has:{metadata:"group8"},metadata:"position",x:.8,y:.8,weight:.7}],x=$(d).parent().width(),D=$(d).parent().height(),e={},E=null;e.data=f.data;e.margin={top:20,right:20,bottom:20,left:20};var G=$(d).css("display");$(d).css("display","block").css("height","800px");e.width=$(d).width()-e.margin.left-
e.margin.right;e.height=$(d).height()-e.margin.top-e.margin.bottom;$(d).css("display",G);for(var F in e.data){var p=e.data[F];p.positionConstraints=[];p.linkStrength=1;u.forEach(function(c){for(var d in c.has)if(c.has[d]!==p[d])return!0;switch(c.metadata){case "position":p.positionConstraints.push({weight:c.weight,x:c.x*e.width,y:c.y*e.height});break;case "linkStrength":p.linkStrength*=c.strength}})}e.links=[];for(F in e.data){var p=e.data[F],y;for(y in p.depends)u={source:e.data[p.depends[y]],target:p},
u.strength=(u.source.linkStrength||1)*(u.target.linkStrength||1),e.links.push(u)}e.categories={};for(F in e.data)p=e.data[F],y=p.metadata+":"+(p.group||""),u=e.categories[y],p.categoryKey=y,u||(u=e.categories[y]={key:y,metadata:p.metadata,typeName:t[p.metadata]?t[p.metadata]["short"]:p.metadata,group:p.group,count:0}),u.count++;e.categoryKeys=d3.keys(e.categories);e.colors=colorbrewer.Set3[12];e.strokeColor=g(.7);e.fillColor=g(-.1);e.nodeValues=d3.values(e.data);$(d).empty();t=d3.zoom().scaleExtent([.5,
4]).on("zoom",function(){var c=d3.zoomTransform(this);e.svg.attr("transform",c);console.log("forceRedraw:"+c.k)});e.svg=d3.select(d).append("svg").attr("class","data-force-svg").attr("width",x).attr("height",D).call(t).append("g").attr("class","force-g");var w=d3.forceSimulation().force("link",d3.forceLink().id(function(c){return c.id}).distance(150)).force("charge",d3.forceManyBody().strength(-200)).force("center",d3.forceCenter(x/2,D/2));e.svg.append("defs").selectAll("marker").data(["end"]).enter().append("marker").attr("id",
String).attr("viewBox","0 -5 10 10").attr("refX",10).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5");e.legend=d3.select(d).append("div").attr("class","legend-container").append("svg").attr("height","100%").append("g").attr("class","legend").attr("x",0).attr("y",0).selectAll(".category").data(d3.values(e.categories)).enter().append("g").attr("class","category");e.legendConfig={rectWidth:12,rectHeight:12,xOffset:0,yOffset:30,
xOffsetText:20,yOffsetText:10,lineHeight:15};e.legendConfig.xOffsetText+=e.legendConfig.xOffset;e.legendConfig.yOffsetText+=e.legendConfig.yOffset;e.legend.append("rect").attr("x",e.legendConfig.xOffset).attr("y",function(c,d){return e.legendConfig.yOffset+d*e.legendConfig.lineHeight}).attr("height",e.legendConfig.rectHeight).attr("width",e.legendConfig.rectWidth).attr("fill",function(c){return e.fillColor(c.key)}).attr("stroke",function(c){return e.strokeColor(c.key)});e.legend.append("text").attr("x",
e.legendConfig.xOffsetText).attr("y",function(c,d){return e.legendConfig.yOffsetText+d*e.legendConfig.lineHeight}).text(function(c){return c.typeName+(c.group?": "+c.group:"")});$(d).on("scroll",function(){e.legend.attr("transform","translate(0,"+$(this).scrollTop()+")")});e.line=e.svg.append("g").style("stroke","#aaa").selectAll(".link").data(e.links).enter().append("line").attr("class","link");e.node=e.svg.selectAll(".node").data(e.nodeValues).enter().append("g").attr("class","node").call(d3.drag().on("start",
function(c){d3.event.active||w.alphaTarget(.3).restart();c.fx=c.x;c.fy=c.y}).on("drag",m).on("end",function(c){d3.event.active||w.alphaTarget(0);c.fx=null;c.fy=null;m(c)||z(c,this);c.fixed&=-7}));e.nodeRect=e.node.append("rect").attr("rx",5).attr("ry",5).attr("stroke",function(c){return e.strokeColor(c.categoryKey)}).attr("fill",function(c){return e.fillColor(c.categoryKey)}).attr("width",120).attr("height",30);var k=[" ","/","_","-","."];e.node.each(function(c){var d=d3.select(this);d.select("rect");
c=h(c.name);var e=-1.1*c.length/2+.5;c.forEach(function(c){d.append("text").text(c).attr("dy",e+"em");e+=1.1})});w.nodes(e.nodeValues).on("tick",function(){e.numTicks++;e.line.attr("x1",function(c){return c.source.x}).attr("y1",function(c){return c.source.y}).each(function(c){var d=c.target.x,e=c.target.y,f=new geo.LineSegment(c.source.x,c.source.y,d,e),g;for(g in c.target.edge){var h=f.intersect(c.target.edge[g].offset(d,e));if(h.in1&&h.in2){d=h.x;e=h.y;break}}d3.select(this).attr("x2",d).attr("y2",
e)});e.node.attr("transform",function(c){return"translate("+c.x+","+c.y+")"})});w.force("link").links(e.links);e.svg.transition().duration(1E3).call(t.transform,d3.zoomIdentity.scale(1).translate(0,0)).on("end",function(){var c=d3.zoomTransform("svg.data-force-svg");c.k=1;c.x=0;c.y=0});setTimeout(function(){e.node.each(function(c){var d=d3.select(this),e={},f=!0;d.selectAll("text").each(function(){var c=this.getBBox();if(f||c.x<e.x1)e.x1=c.x;if(f||c.y<e.y1)e.y1=c.y;if(f||c.x+c.width>e.x2)e.x2=c.x+
c.width;if(f||c.y+c.height>e.y2)e.y2=c.y+c.height;f=!1}).attr("text-anchor","middle");var g=e.x2-e.x1;e.x1-=g/2;e.x2-=g/2;e.x1-=3;e.y1-=2;e.x2+=6;e.y2+=4;d.select("rect").attr("x",e.x1).attr("y",e.y1).attr("width",e.x2-e.x1).attr("height",e.y2-e.y1);c.extent={left:e.x1-3,right:e.x2+3+3,top:e.y1-2,bottom:e.y2+2+2};c.edge={left:new geo.LineSegment(e.x1,e.y1,e.x1,e.y2),right:new geo.LineSegment(e.x2,e.y1,e.x2,e.y2),top:new geo.LineSegment(e.x1,e.y1,e.x2,e.y1),bottom:new geo.LineSegment(e.x1,e.y2,e.x2,
e.y2)}});e.numTicks=0;$(d).css("visibility","visible")});$(d).on("click",function(c){$(c.target).closest(".node").length||v()})};
